# 柱子统计分析脚本 - 快速使用指南

## 🚀 快速开始

### 方法一：使用启动脚本（推荐）
1. 双击 `启动脚本.bat` 文件
2. 选择功能：
   - 选项1：DWG转DXF格式转换工具
   - 选项2：柱子区域统计分析

### 方法二：命令行运行
- **转换DWG文件**：`python "DWG转换工具.py"`
- **分析柱子**：`python main.py`

## 📁 文件格式支持

### 🔄 现在支持DWG文件！
脚本现在可以：
1. **自动检测**DWG文件并提供转换指导
2. **智能识别**已转换的DXF文件
3. **多种转换方案**：AutoCAD、免费软件、在线服务

### 转换方案
1. **AutoCAD转换**（推荐）
   - 文件 → 打开DWG → 另存为DXF

2. **免费CAD软件**
   - DraftSight、LibreCAD、QCAD等

3. **在线转换服务**
   - Zamzar、Convertio等在线平台

### 配置文件路径
编辑 `config.py` 文件：
```python
# 修改这行为您的DXF文件路径
DXF_FILE_PATH = r"您的DXF文件完整路径"
```

## ✅ 运行要求

### 系统要求
- Windows 7/10/11
- Python 3.7 或更高版本

### 依赖库
脚本会自动检查，如果缺少会提示安装：
```bash
pip install ezdxf==1.3.0
```

## 📊 结果说明

脚本运行后会显示：
- 每个负责人的区域统计
- 各区域的柱子数量
- 总计统计信息
- 详细日志保存在 `柱子统计分析.log`

## ❗ 常见问题

### 问题1：找不到文件
**错误**：`文件不存在`
**解决**：
1. 确认DXF文件路径正确
2. 检查文件是否存在
3. 确认已将DWG转换为DXF

### 问题2：没有找到柱子
**可能原因**：
1. 柱子标记不包含字母"Z"
2. 柱子在非标准图层
3. 柱子是块引用且名称不包含"Z"

**解决**：
1. 检查图纸中柱子的标记方式
2. 如需要，修改 `config.py` 中的 `COLUMN_IDENTIFIER`

### 问题3：轴网识别错误
**可能原因**：
1. 轴网标记不是纯数字或纯字母
2. 轴网标记在特殊位置

**解决**：
1. 检查轴网标记格式
2. 启用详细日志查看识别过程

## 🔧 高级设置

### 启用详细日志
在 `config.py` 中设置：
```python
LOG_LEVEL = 'DEBUG'
```

### 修改柱子识别规则
在 `config.py` 中修改：
```python
COLUMN_IDENTIFIER = '您的标识符'  # 例如：'柱'、'Z'、'C' 等
```

## 📞 技术支持

如果遇到问题：
1. 查看 `柱子统计分析.log` 文件中的错误信息
2. 启用DEBUG模式获取详细信息
3. 检查DXF文件格式和内容

---
**版本**：1.0  
**最后更新**：2025年1月27日
