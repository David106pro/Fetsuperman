
#### 背景
- 公司推出了考勤制度，我作为电脑部人员需要写一个脚本，帮助人事部同事提高考勤数据整理的效率，请用python帮我写一个脚本，实现输入日明细报表和休假出差表，输出考勤表

#### 输入表格
	脚本运行后会输入两个表格
1. 日明细报表
	- 日明细报表为所有公司人员的打卡记录，需要根据这个表格整理出所有员工每个月的打卡记录
	- 以A列的人员编号为key来区分不同员工，如果没有编号的行不计入数据，编号样例：19379（以五位数字组成）
	- 以B列为员工姓名，姓名样例：王巧唯
	- 以D列为部门名称，部门名称样例：(o)法律部
	- 以E列为考勤日期，考勤日期样例：2025-05-06
	- 以J列的数据作为打卡数据
		- 数据格式样例：09:06-18:38;
		- 数据解释：“-”前为上班打卡时间，“-”后为下班打卡时间
		- 特殊情况：
			- 如果上班或下班缺卡，则以?代替，例如（下班缺卡）：09:09-?;
			- 如果没来公司（上下班都未打卡），则为空白
2. 休假出差表
	- 休假出差表为所有公司人员的休假记录，需要根据这个表格整理出所有员工每个月的休假记录
	- 以A列的人员编号为key来区分不同员工，如果没有编号的行不计入数据，编号样例：25037（以五位数字组成）
	- 以C列为员工姓名，姓名样例：傅立光
	- 以D列为请假原因，请假原因样例：年假
		- 请假原因选项：年假、病假、事假、婚假、外出
		- 备注：如果请假不为整天（半天假期），则会在选项中显示半天，例如：外出（上午）
	- 以F列为请假开始日期，开始日期样例：2024/10/18
	- 以G列为请假结束日期，结束日期样例：2024/10/18
	- 以H列为半天标记，如果请假为半天会在该列进行标记，半天标记样例：半天


#### 输出表格
根据这两个表格生成一系列考勤表，表格名为：人员姓名_YYYYMM_考勤表
1. 考勤表公司某一人员某月的所有考勤记录，需要根据两个输入表格生成该表格，每个员工生成一个
2. 表格内容
	1. 第一行为表头，存储在第第一行第一列单元格，格式为：YYYY年MM月考勤表，示例如下：2025年5月考勤表
	2. 第二行为员工基本信息
		1. 第一个单元格存放”姓名“两字
		2. 第二个单元格存放员工姓名，示例：傅立光
		   获取方式：日明细报表对应人员编号的B列数据
		3. 第三个单元格存放”部门“两字
		4. 第四个单元格存放员工部门，示例：(f)电脑部
		   获取方式：日明细报表对应人员编号的D列数据
	3. 从第三行开始为考勤表表头，表头从左到右为：星期，日期，上班，下班，迟到，早退，加班，备注
	4. 从第四行开始为考勤表内容，每列内容详情如下
		1. 第一列为星期数，用中文汉字表明，如果当天为星期四，则显示：四
		   获取方式：根据出勤日期自行判断
		2. 第二列为出勤日期，例如：2025/5/1
		   获取方式：根据每个月的天数，自动填充（从1日至该月最后一天从上到下自动填充）
		3. 第三列为上班打卡时间，例如：07:56
		   获取方式：日明细报表 对应人员编号 对应考勤日期（E列）对应J列数据“-”前面部分
		4. 第四列为下班打卡时间，例如：17:48
			获取方式：日明细报表 对应人员编号 对应考勤日期（E列）对应J列数据“-”后面部分				   
		5. 第五列为迟到时长，以分钟为单位，例如：40
		   获取方式：
			1. 若上班打卡时间早于或等于9:15，则为空白
			2. 若上班打卡时间晚于9:15，则计算打卡时间距离9:15的分钟数
		6. 第六列为早退时长，以分钟为单位，例如：40
		   获取方式：
			1. 工作时长计算方式：先通过上下班打卡时间相减，计算当日工作时间，以分钟为单位，计为工作时长
			2. 若未迟到：
				1. 工作时长<480分钟，则用480-工作时长，记作早退时长
				2. 工作时长>480分钟，则计为加班时长
			3. 若迟到：
				1. 用下班打卡时间和17:45进行比较
					1. 若结果为正，则计为加班时长
					2. 若结果为负，则计为早退时长
		7. 第七列为加班时长，以分钟为单位，例如：40
		   获取方式：参考第六条的加班时长
		8. 第八列为备注，记录特殊情况原因，例如：旷工
		   获取方式：
			1. 如果有迟到、早退现象，则填入“迟到，早退，迟到+早退”
			2. 如果有缺卡情况，则填入“上班缺卡，下班缺卡，旷工”
	5. 若休假出差表中有数据
		1. 根据第一列人员编号，锁定对应员工的考勤表
		2. 根据休假出差表中对应人员编号的对应起始日期和结束日期 和 考勤表的日期，锁定考勤表对应的行数区间
		3. 根据休假出差表中第四列的原因，在考勤表中填入相同字段
			1. 若当前因日明细报表已填入”旷工“，则覆盖”旷工“数据，填入正确的备注信息
#### UI界面
- 通过CustomTkinter包来完成
- 最上方有两个输入表格路径选择和sheet选择按钮
	- 日明细报表默认路径：C:\Users\fucha\PycharmProjects\python\公司\cursor项目\6.老爹脚本\考勤表格导出\日明细报表_20250603101227.xlsx
	- 休假出差表默认路径：C:\Users\fucha\PycharmProjects\python\公司\cursor项目\6.老爹脚本\考勤表格导出\休假出差表_20250603.xlsx
- 在其下方有两个输入框，可输入员工编号和员工姓名只允许输入一个，若同时输入，则点击开始运行后弹出提示框，“员工编号和员工姓名仅允许输入一个“
- 中间为表格预览区域，只展示一个表格，默认展示最后导入的表格，其左侧可以切换展示不同表格
- 展示区域下方有表格生成路径选择，默认路径为：C:\Users\fucha\PycharmProjects\python\公司\cursor项目\6.老爹脚本\考勤表格导出
- 最下方有开始生成按钮，点击该按钮，开始脚本运行，若输入框为空，则正常运行（生成全部员工表格），若输入框均不为空，则只生成该员工编号或员工姓名对应数据的表格

#### 代码运行逻辑
- 当开始运行脚本，弹出UI操控页面，当选择好输入路径和输出路径后，点击开始运行脚本，根据上述规则生成输出表格（考勤表）
- 输出路径：C:\Users\fucha\PycharmProjects\python\公司\cursor项目\6.老爹脚本\考勤表格导出\生成表格
- 运行结束后，自动打开生成表格目录（文件夹），若只生成一个表格，则打开该表格