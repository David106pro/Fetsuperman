# Excel 比对工具 - 增强模糊匹配功能说明

## 功能概述

增强的模糊匹配功能采用了优先级分层的匹配策略，能够更智能地识别和匹配相似的关键字，支持丰富的文本变换规则。新版本增加了进度监控和优化的匹配算法。

## 最新优化功能

### 🔄 实时进度监控
- 添加了进度条显示处理进度
- 实时显示当前处理状态
- 清晰的进度反馈，包括文件加载、数据分析、匹配处理等阶段

### 🎨 优化视觉效果
- **军绿色 (#556B2F)**：优先级2匹配（符号转换、数字格式等）
- **海蓝色 (#000080)**：优先级3匹配（包含关系）
- **血红色 (#8B0000)**：优先级3匹配中的短文本包含情况（2字以内）

### 🧠 智能匹配算法
- **优先级3优化**：改为选择字数最相近的匹配项
- 当有多个子字符串匹配时，优先选择与原文字数最接近的候选项
- 相同长度差时，选择更长的文本（包含更多信息）

## 匹配优先级

### 优先级1：精确匹配 (P1)
- 直接比较两个字符串是否完全相同
- 最高优先级，如果找到精确匹配，不会继续其他优先级的匹配

**示例**：
- `反贪风暴` ↔ `反贪风暴` ✓

### 优先级2：符号、大小写、数字变体匹配 (P2)
支持多种文本变换规则，生成所有可能的变体进行匹配：

#### 1. **连词处理**
- 删除连词：删除"之"、"的"、"和"
- 连词替换：`之` ↔ `的` ↔ `和`

**示例**：
- `猪猪侠之武侠2008` ↔ `猪猪侠和武侠2008` ✓
- `猪猪侠之武侠2008` ↔ `猪猪侠2武侠2008` ✓

#### 2. **符号处理**
- 删除中间符号：删除冒号、括号等符号
- 符号添加：在需要的位置添加符号
- 符号替换：各种符号间的互相替换
- 符号格式变化：全角半角转换

**支持的符号转换**：
- `：` ↔ `:` (全角半角)
- `（` ↔ `(` ↔ `[`
- `）` ↔ `)` ↔ `]`
- `！` ↔ `!`
- `－` ↔ `—` ↔ `-` ↔ `_` ↔ 删除
- `【` ↔ `[` ↔ `(`
- `】` ↔ `]` ↔ `)`

**示例**：
- `24小时：末路重生` ↔ `24小时末路重生` ✓
- `白蛇2青蛇劫起` ↔ `白蛇2：青蛇劫起` ✓
- `纯真年代(2018)` ↔ `纯真年代_2018` ✓
- `滚蛋吧！肿瘤君` ↔ `滚蛋吧!肿瘤君` ✓

#### 3. **大小写转换**
- 支持大小写不敏感匹配

**示例**：
- `BEYOND日记之莫欺少年穷` ↔ `beyond日记之莫欺少年穷` ✓

#### 4. **数字格式转换**
- 阿拉伯数字 ↔ 中文数字：`1234567890` ↔ `一二三四五六七八九零`
- 罗马数字转换：`I II III IV V VI VII VIII IX X` 和 `Ⅰ Ⅱ Ⅲ Ⅳ Ⅴ Ⅵ Ⅶ Ⅷ Ⅸ Ⅹ` → `12345678910`

**示例**：
- `斗罗大陆2绝世唐门第5季` ↔ `斗罗大陆2绝世唐门第五季` ✓
- `诛仙Ⅰ` ↔ `诛仙1` ✓

#### 5. **多季专辑处理**
支持以下格式的相互转换：
- 仅有数字：`2`
- 第x季：`第2季` / `第二季` / `第II季`
- 第x部：`第2部` / `第二部` / `第II部`
- Season格式：`S2` / `Season 2`
- 第x集：`第2集` / `第二集` / `第II集`
- 第x代：`第2代` / `第二代` / `第II代`

**示例**：
- `斗罗大陆3龙王传说2` ↔ `斗罗大陆3龙王传说第2季` ✓
- `斗罗大陆3龙王传说2` ↔ `斗罗大陆3龙王传说第二季` ✓
- `斗罗大陆3龙王传说2` ↔ `斗罗大陆3龙王传说第II季` ✓
- `斗罗大陆3龙王传说2` ↔ `斗罗大陆3龙王传说第2部` ✓
- `斗罗大陆3龙王传说2` ↔ `斗罗大陆3龙王传说S2` ✓

### 优先级3：智能子字符串匹配 (P3) ⭐新优化⭐
- 检查一个字符串是否包含在另一个字符串中
- **智能选择算法**：当有多个匹配项时，选择字数最相近的候选项
- 相同长度差时，优先选择更长的文本（包含更多信息）

**选择逻辑示例**：
- 原文：`测试内容`（4字符）
- 候选：
  - `这是一个测试内容的详细描述`（12字符，长度差8）
  - `测试内容说明`（6字符，长度差2）✓ **被选中**
  - `测试内容详细版本介绍说明`（12字符，长度差8）

**示例**：
- `宾得：终章` ↔ `奥斯特帕宾得：终章` ✓ (原名是匹配名的一部分)
- `干胡椒和黑魔王的治愈(干胡椒大魔王)` ↔ `干胡椒和黑魔王的治愈` ✓ (匹配名是原名的一部分)

## 使用方法

1. 在GUI界面中勾选"启用模糊匹配"选项
2. 选择相应的Excel文件和列
3. 点击"开始处理"
4. **观察进度条**：实时查看处理进度和当前状态
5. 匹配结果会在关键字列右侧添加新列显示
6. 匹配的数据会根据优先级用不同颜色标识

## 技术特点

- **🔄 实时进度监控**：进度条显示处理状态，用户体验更佳
- **🎨 优化视觉效果**：更深层次的颜色，更好的视觉辨识度
- **🧠 智能选择算法**：P3匹配选择字数最相近的结果
- **📊 全面的文本变换**：支持连词、符号、大小写、数字、多季专辑等多种变换
- **⚡ 高效的匹配算法**：生成所有可能变体进行匹配
- **🛡️ 强大的容错能力**：能处理各种文本格式差异
- **🎯 清晰的视觉反馈**：不同颜色标识不同匹配类型
- **🈳 中文优化**：专门针对中文文本特点进行优化 