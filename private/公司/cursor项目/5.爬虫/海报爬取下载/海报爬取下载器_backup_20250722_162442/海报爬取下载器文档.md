# 海报爬取下载器文档

## 一、脚本简述

### 项目功能
- 支持爱奇艺、腾讯视频、优酷三大平台的海报图片搜索与下载
- 支持单平台、批量Excel、VIP标识检测、批量删除错误海报等多种模式
- 支持自定义下载路径、图片尺寸、文件名格式等
- 支持批量处理、进度显示、错误提示、日志记录

### 操作流程
1. 启动程序：`python mainPro.py`
2. 选择左侧功能（经典爬取/批量爬取/批量删除错误海报/VIP标识检测/设置）
3. 按界面提示输入关键词、选择平台、设置参数
4. 查看结果，勾选需要下载的图片，点击下载
5. 批量模式下，按Excel模板准备数据，按提示操作

### 使用条件
- Python 3.7+
- 需安装依赖：customtkinter、requests、Pillow、pandas、openpyxl、bs4
- 需有网络连接和足够磁盘空间
- 推荐先运行`python setup.py`自动配置环境

### 主要UI结构
- 左侧工具栏：功能切换
- 右侧内容区：根据功能显示搜索、批量、删除、设置等页面
- 结果区支持多列展示、图片预览、批量勾选、进度条等

---

## 二、脚本版本更新历程

### 主要优化与功能迭代
- UI重构为多页面布局，左侧导航+右侧内容区
- 新增批量爬取、批量删除、VIP检测等功能
- 支持Excel导入、批量处理、进度实时保存
- 支持自定义图片尺寸、路径、文件名格式
- 优化错误处理、日志输出、用户提示
- 支持多平台（爱奇艺/腾讯/优酷）切换与优先级自定义
- 优化表格预览、批量处理、删除等细节体验

### 重要Bug修复与功能删除
- 修复CTkCheckBox wraplength参数报错
- 修复爱奇艺/优酷API调试信息缺失问题
- 优化多平台并发搜索的异常处理与超时保护
- 删除“三平台同时”模式，简化为单平台稳定搜索
- 优化批量处理、批量删除的表格高亮与进度保存
- 详细见下方“批量爬取模式使用说明”与历史文档记录

---

## 三、批量爬取模式使用说明

### Excel批量处理
- Excel需包含“影片名称”“CID”两列，支持多个Sheet
- 支持.xlsx/.xls格式，推荐使用模板
- 批量处理时，自动保存进度到原Excel，支持断点续传
- 处理状态、获取图片标题等会自动写入新列

### 批量删除错误海报
- Excel首列为需删除的文件名（不含扩展名）
- 支持多Sheet分类管理
- 删除前请备份重要文件，操作不可撤销
- 支持多种图片格式智能匹配删除

### 配置与注意事项
- 推荐先运行`python setup.py`自动安装依赖并初始化配置
- 默认下载路径为桌面，可在设置中修改
- 支持自定义图片尺寸、文件名格式、优先级等
- 详细参数与操作见程序内“设置”页面

### 常见问题与注意事项
- 网络异常、Cookie失效、Excel格式错误等会有详细提示
- 删除操作不可撤销，务必备份数据
- 详细技术细节、历史优化、bug修复见本文件前两部分

---

*本文件为项目唯一官方文档，包含全部功能说明、历史记录与批量模式操作指引。* 